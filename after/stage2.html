<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Character Selection</title>

<style>
    html {
        background-image: url(background2.webp);
        background-size: cover; 
        background-position: center; 
        background-repeat: no-repeat; 
        height: 100vh;
        margin: 0;
    }

    @font-face {
        font-family: gu;
        src: url(ChosunGu.TTF);
    }

    .skin, .eyes, .bodyType {
        position: absolute;
        display: block;
    }

    .skin { top: 5vh; left: 2vw; width: 15vw; padding: 1vw; }
    .skin img { width: 5vw; cursor: pointer; }

    .eyes { top: 3vw; left: 17vw; }
    .eyes img { width: 5vw; padding: 3vw; cursor: pointer; }

    .bodyType { top: 25vh; left: 2vw; display: flex; gap: 1vw; }
    .bodyType img { width: 14vw; cursor: pointer; }

    #bodyDisplay img, #eyesDisplay img { height: 85vh; position: absolute; right: 8vw; top: 6vh; }

    .done { position: absolute; width: 15vw; right: 0; top: 0; cursor: pointer; }

    #infoButton { position: absolute; bottom: 2vh; left: 2vw; width: 4vw; min-width: 30px; cursor: pointer; z-index: 10; }

    #infoModal { position: fixed; inset: 0; background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(4px); display: none; justify-content: center; align-items: center; z-index: 20; }
    #infoContent { background: #ffffff; padding: 3vh 3vw; border-radius: 1vh; width: 50vw; max-width: 600px; text-align: center; color: #fab6df; font-size: 2vh; box-shadow: 0 0 1.5vh #fab6df; position: relative; font-family: gu; }
    #closeModal { position: absolute; top: 1vh; right: 1vw; font-size: 3vh; cursor: pointer; color: #fab6df; background: none; border: none; }
</style>
</head>

<body>

<!-- Skin Selection -->
<div class="skin">
    <img src="skin1.webp" id="skin1">
    <img src="skin2.webp" id="skin2">
    <img src="skin3.webp" id="skin3">
    <img src="skin4.webp" id="skin4">
</div>

<!-- Eye Selection -->
<div class="eyes">
    <img src="black.png" id="black">
    <img src="brown.png" id="brown">
    <img src="blue.png" id="blue">
    <img src="green.png" id="green">
</div>

<!-- Body Type Selection -->
<div class="bodyType">
    <img src="skinny.webp" id="skinny">
    <img src="tall.webp" id="tall">
    <img src="short.webp" id="short">
    <img src="fat.webp" id="fat">
</div>

<!-- Display Areas -->
<div id="bodyDisplay"></div>
<div id="eyesDisplay"></div>

<!-- Done Button -->
<img class="done" src="done.webp" alt="Done">

<!-- Info Button -->
<img src="info.webp" id="infoButton">

<!-- Modal -->
<div id="infoModal">
    <div id="infoContent">
        <strong>Why We Ask For This</strong><br><br>
        Under the Unified Population Protocol, every citizen undergoes physical assessment before progressing through the Selection Program.
        <br><br>
        Certain bodily characteristics “optimize reproductive reliability” and “increase projected societal value.”
        <br><br>
        <button id="closeModal">&times;</button>
    </div>
</div>

<script>
const bodyDisplay = document.getElementById('bodyDisplay');
const eyesDisplay = document.getElementById('eyesDisplay');

let selectedSkin = '';
let isFat = false;
let isShort = false;

// Update body image
function updateBody() {
    if (!selectedSkin) selectedSkin = 'body1';
    let bodyName = selectedSkin;
    if (isFat) bodyName += 'fat';
    if (isShort) bodyName += 'short';
    bodyDisplay.innerHTML = `<img src="${bodyName}.png" alt="Body Image">`;

    // Save chosen body for results
    localStorage.setItem('chosenBody', `${bodyName}.png`);

    // Save body points
    let bodyPoints = 0;
    if ((isFat && isShort)) bodyPoints = -1;
    else if (!isFat && !isShort) bodyPoints = 1;
    else bodyPoints = 0;
    localStorage.setItem('bodyPoints', bodyPoints);

    // Save display text
    let heightText = isShort ? 'Short' : 'Tall';
    let weightText = isFat ? 'Fat' : 'Skinny';
    localStorage.setItem('heightText', heightText);
    localStorage.setItem('weightText', weightText);
}

// Skin
document.getElementById('skin1').onclick = () => { selectedSkin = 'body1'; updateBody(); };
document.getElementById('skin2').onclick = () => { selectedSkin = 'body2'; updateBody(); };
document.getElementById('skin3').onclick = () => { selectedSkin = 'body3'; updateBody(); };
document.getElementById('skin4').onclick = () => { selectedSkin = 'body4'; updateBody(); };

// Body Types
document.getElementById('skinny').onclick = () => { isFat = false; isShort = false; updateBody(); };
document.getElementById('tall').onclick = () => { isShort = false; updateBody(); };
document.getElementById('short').onclick = () => { isShort = true; updateBody(); };
document.getElementById('fat').onclick = () => { isFat = true; updateBody(); };

// Eyes
document.getElementById('black').onclick = () => { eyesDisplay.innerHTML = '<img src="blackeyes.png">'; localStorage.setItem('chosenEyes','blackeyes.png'); };
document.getElementById('brown').onclick = () => { eyesDisplay.innerHTML = '<img src="browneyes.png">'; localStorage.setItem('chosenEyes','browneyes.png'); };
document.getElementById('blue').onclick = () => { eyesDisplay.innerHTML = '<img src="blueeyes.png">'; localStorage.setItem('chosenEyes','blueeyes.png'); };
document.getElementById('green').onclick = () => { eyesDisplay.innerHTML = '<img src="greeneyes.png">'; localStorage.setItem('chosenEyes','greeneyes.png'); };

// Done Button
document.querySelector('.done').onclick = () => {
    window.location.href = 'stage3.html';
};

// Modal logic
const infoButton = document.getElementById('infoButton');
const infoModal = document.getElementById('infoModal');
const closeModal = document.getElementById('closeModal');
infoButton.onclick = () => infoModal.style.display = 'flex';
closeModal.onclick = () => infoModal.style.display = 'none';
infoModal.onclick = e => { if(e.target === infoModal) infoModal.style.display = 'none'; };
</script>

</body>
</html>
